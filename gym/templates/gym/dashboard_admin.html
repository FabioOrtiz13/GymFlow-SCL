{% extends 'gym/base.html' %}

{% block title %}Dashboard Admin - GymFlow{% endblock %}

{% block content %}
<div class="page-header">
    <h1>ğŸ‘‘ Panel de AdministraciÃ³n</h1>
    <p class="text-muted">Â¡Hola, {{ user.username }}! Vista general del sistema GymFlow</p>
</div>

<!-- EstadÃ­sticas Generales -->
<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-number">{{ total_usuarios }}</div>
        <div class="stat-label">ğŸ‘¤ Usuarios</div>
    </div>
    <div class="stat-card">
        <div class="stat-number">{{ total_entrenadores }}</div>
        <div class="stat-label">ğŸ‘¨â€ğŸ« Entrenadores</div>
    </div>
    <div class="stat-card">
        <div class="stat-number">{{ total_rutinas }}</div>
        <div class="stat-label">ğŸ“‹ Rutinas</div>
    </div>
    <div class="stat-card">
        <div class="stat-number">{{ total_ejercicios }}</div>
        <div class="stat-label">ğŸ‹ï¸ Ejercicios</div>
    </div>
    <div class="stat-card">
        <div class="stat-number">{{ total_entrenamientos }}</div>
        <div class="stat-label">âœ… Entrenamientos</div>
    </div>
</div>

<!-- Accesos RÃ¡pidos -->
<div class="card">
    <h2>âš¡ Accesos RÃ¡pidos</h2>
    <div class="d-flex gap-1">
        <a href="/admin/" class="btn btn-primary">ğŸ”§ Panel Django Admin</a>
        <a href="{% url 'entrenadores_list' %}" class="btn btn-primary">ğŸ‘¨â€ğŸ« Ver Entrenadores</a>
        <a href="{% url 'rutinas_list' %}" class="btn btn-primary">ğŸ“‹ Ver Rutinas</a>
        <a href="{% url 'ejercicios_list' %}" class="btn btn-primary">ğŸ‹ï¸ Ver Ejercicios</a>
    </div>
</div>

<!-- Usuarios Recientes -->
<div class="card">
    <h2>ğŸ†• Usuarios Recientes</h2>
    
    {% if usuarios_recientes %}
    <table class="table">
        <thead>
            <tr>
                <th>Usuario</th>
                <th>Email</th>
                <th>Tipo</th>
                <th>Fecha Registro</th>
                <th>Estado</th>
            </tr>
        </thead>
        <tbody>
            {% for usuario in usuarios_recientes %}
            <tr>
                <td>{{ usuario.username }}</td>
                <td>{{ usuario.email|default:"â€”" }}</td>
                <td>
                    {% if usuario.perfil.tipo_usuario == 'administrador' %}
                        ğŸ‘‘ Admin
                    {% elif usuario.perfil.tipo_usuario == 'entrenador' %}
                        ğŸ‘¨â€ğŸ« Entrenador
                    {% else %}
                        ğŸ’ª Usuario
                    {% endif %}
                </td>
                <td>{{ usuario.date_joined|date:"d/m/Y H:i" }}</td>
                <td>
                    {% if usuario.is_active %}
                    <span class="badge badge-success">Activo</span>
                    {% else %}
                    <span class="badge badge-danger">Inactivo</span>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p class="text-muted">No hay usuarios registrados aÃºn.</p>
    {% endif %}
</div>

<!-- Rutinas MÃ¡s Populares -->
{% if rutinas_populares %}
<div class="card">
    <h2>ğŸ”¥ Rutinas MÃ¡s Populares</h2>
    
    <table class="table">
        <thead>
            <tr>
                <th>Rutina</th>
                <th>Creador</th>
                <th>Entrenamientos</th>
                <th>Dificultad</th>
                <th>Estado</th>
            </tr>
        </thead>
        <tbody>
            {% for rutina in rutinas_populares %}
            <tr>
                <td><a href="{% url 'rutina_detail' rutina.id %}">{{ rutina.nombre }}</a></td>
                <td>{{ rutina.usuario.username }}</td>
                <td><strong>{{ rutina.num_entrenamientos }}</strong></td>
                <td>{{ rutina.get_dificultad_display }}</td>
                <td>
                    {% if rutina.activa %}
                    <span class="badge badge-success">Activa</span>
                    {% else %}
                    <span class="badge badge-secondary">Inactiva</span>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endif %}

<!-- Entrenadores MÃ¡s Activos -->
{% if entrenadores_activos %}
<div class="card">
    <h2>â­ Entrenadores MÃ¡s Activos</h2>
    
    <table class="table">
        <thead>
            <tr>
                <th>Entrenador</th>
                <th>Email</th>
                <th>Rutinas Asignadas</th>
                <th>Especialidad</th>
            </tr>
        </thead>
        <tbody>
            {% for entrenador in entrenadores_activos %}
            <tr>
                <td>ğŸ‘¨â€ğŸ« {{ entrenador.username }}</td>
                <td>{{ entrenador.email|default:"â€”" }}</td>
                <td><strong>{{ entrenador.num_rutinas_asignadas }}</strong></td>
                <td>{{ entrenador.perfil.especialidad|default:"â€”" }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endif %}

<!-- InformaciÃ³n del Sistema -->
<div class="card">
    <h2>â„¹ï¸ InformaciÃ³n del Sistema</h2>
    
    <div class="grid">
        <div>
            <h4>Estado del Sistema</h4>
            <p>âœ… Operativo</p>
            <p>ğŸ”’ Seguridad: Django {{ request.version }}</p>
        </div>
        
        <div>
            <h4>Base de Datos</h4>
            <p>ğŸ“Š MySQL - Puerto 3308</p>
            <p>ğŸ—„ï¸ Base: db_gym</p>
        </div>
        
        <div>
            <h4>Funcionalidades</h4>
            <p>âœ… ExerciseDB API: 5000+ ejercicios</p>
            <p>âœ… Sistema de asignaciÃ³n de rutinas</p>
            <p>âœ… Registro de progreso fÃ­sico</p>
        </div>
    </div>
</div>

<!-- Acciones de AdministraciÃ³n -->
<div class="card">
    <h2>ğŸ› ï¸ GestiÃ³n del Sistema</h2>
    
    <div class="alert alert-info">
        <strong>ğŸ’¡ Tip:</strong> Para gestiÃ³n avanzada de usuarios, perfiles y datos, 
        usa el <a href="/admin/" class="alert-link">Panel de Django Admin</a>.
    </div>
    
    <h4>Tareas comunes:</h4>
    <ul>
        <li>ğŸ“ <a href="/admin/gym/perfilusuario/">Gestionar perfiles de usuario</a></li>
        <li>ğŸ‘¨â€ğŸ« <a href="/admin/gym/perfilusuario/?tipo_usuario=entrenador">Gestionar entrenadores</a></li>
        <li>ğŸ‹ï¸ <a href="/admin/gym/ejercicio/">Gestionar ejercicios</a></li>
        <li>ğŸ“‹ <a href="/admin/gym/rutina/">Gestionar rutinas</a></li>
        <li>ğŸ‘¤ <a href="/admin/auth/user/">Gestionar usuarios Django</a></li>
    </ul>
</div>
{% endblock %}

